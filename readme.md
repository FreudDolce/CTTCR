# The CATCR model

This model contains CATCR-D and CATCR-G, where CATCR-D is a discriminative model to predict epitope-CDR3-beta pairs, and CATCR-G is a generative model to generate CDR3-beta sequences bind to a given epitope.

## Train and Test data

Test data used for this model can be downloaded from "".

- The internal test data ("seen" epitope but "unseen" CDR3)
- The external test data (both epitope and CDR3 were unseen)
- The pdb data was generated by OpenAI (a pytorch version of AlphaFold2)

## Data Generator

We provide data process tool to pretreat the sequence and pdb data in `DataTransferTools.py`.

- The `PDB2PositionFrame` Module can turn the `.pdb` data into pandas dataframe
- The `RepDistanceAndSequenceMatrix` Module can generate train data for one sequence.
- Note: Segment-based coding method is preferred, the corresponding of peptide sequences and its code is listed in `node_index.csv`

## Train and test

- The CATCR contains 3 modules, the discriminator (CATCR-D), the residue contact matrix transformer (RCMT), and the generative model (CATCR-G)
- The CATCR-D was trained via `SupTrain.py`
- The RCMT was trained via `SturctureTransformer.py`
- The CATCR-G was trained via `e2t_Generator.py`
- Note, in the training of RCMT and CATCR-G, a pretrained epitope encoder is recommonded. Our pretrained models were provided in the `model` folder, or you can train the encoder from beginning.
- The demo for CATCR-D is `D_test.py`, and demo for CATCR-G is `BeamSearch.py`